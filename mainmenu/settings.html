<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="settings.css">
    <title>Account Settings</title>
</head>
<body>
    <div class="page-bg"></div>
    <div class="main-wrapper">

        <div class="container-box">
            <!-- SIDEBAR -->
            <aside class="sidebar">
                <a href="#" id="backBtn" class="back-btn"><i class="bi bi-arrow-left"></i> Back</a>

                <div class="menu-item active" data-page="accountPage">
                    <i class="bi bi-person-fill"></i> Account
                </div>

                <div class="menu-item" data-page="supportPage">
                    <i class="bi bi-info-circle-fill"></i> Support / Help
                </div>

                <div class="menu-item" data-page="feedbackPage">
                    <i class="bi bi-flag-fill"></i> Feedback / Report
                </div>
            </aside>

            <!-- MAIN CONTENT -->
            <main class="content">

                <!-- ACCOUNT PAGE -->
                <section id="accountPage" class="page active">
                    <h2>Account Information</h2>
                    <div class="divider"></div>

                    <div class="info-row">
                        <div class="infoheader">
                            <strong>Username:</strong>
                            <p>Ju4aaan</p>
                        </div>
                        <button class="accountinfobtn">Change Username</button>
                    </div>

                    <div class="info-row">
                        <div class="infoheader">
                            <strong>Email:</strong>
                            <p id="accountEmail">juandelacruz@gmail.com</p>
                        </div>
                        <button class="accountinfobtn">Change Email</button>
                    </div>

                    <div class="info-row">
                        <div class="infoheader">
                            <strong>Password:</strong>
                            <p>************</p>
                        </div>
                        <button class="accountinfobtn">Change Password</button>
                    </div>
                </section>

                <!--Support and Help Page-->
                <section id="supportPage" class="page">
                    <div class="support-wrapper">

                        <h2>Support and Help</h2>
                        <div class="divider"></div>

                        <!-- FAQ SECTION -->
                        <h2 class="support-title">Frequently asked questions</h2>
                        <div class="faq-list">

                            <!-- FAQ ITEM -->
                            <div class="faq-item">
                                <div class="faq-icon-col">
                                    <i class="bi bi-dot bullet-icon"></i>
                                    <i class="bi bi-three-dots-vertical line-icon"></i>
                                </div>

                                <div class="faq-content">
                                    <h3 class="faq-question">How does the real-time jeepney tracking work?</h3>
                                    <p class="faq-answer">
                                        Drivers share their live location when they start their route. 
                                        Commuters can see these jeepneys on the map along with an estimated arrival 
                                        time (ETA) to avoid long waiting times.
                                    </p>
                                </div>
                            </div>

                            <!-- FAQ ITEM -->
                            <div class="faq-item">
                                <div class="faq-icon-col">
                                    <i class="bi bi-dot bullet-icon"></i>
                                    <i class="bi bi-three-dots-vertical line-icon"></i>
                                </div>

                                <div class="faq-content">
                                    <h3 class="faq-question">Why can’t I see any jeepneys on the map?</h3>
                                    <p class="faq-answer">
                                        Jeepneys will only appear if drivers are currently active and sharing their location. 
                                        If no jeepneys are visible, it means no drivers are online on that route at the moment.
                                    </p>
                                </div>
                            </div>

                            <!-- FAQ ITEM -->
                            <div class="faq-item">
                                <div class="faq-icon-col">
                                    <i class="bi bi-dot bullet-icon"></i>
                                    <i class="bi bi-three-dots-vertical line-icon"></i>
                                </div>

                                <div class="faq-content">
                                    <h3 class="faq-question">Does the app track my location as a commuter?</h3>
                                    <p class="faq-answer">
                                        Yes, but only while using the app. 
                                        Your location is used to show your position on the map and calculate accurate ETAs. 
                                        Your data is not shared publicly
                                    </p>
                                </div>
                            </div>

                        </div>

                        <!-- CONTACT FORM -->
                        <h2 class="support-title">Contact us!</h2>
                        <p class="support-desc">
                            Got a specific question? Leave an email to us and we’ll answer as soon as possible!
                        </p>

                        <form class="contact-form">
                            <div class="row">
                                <input type="text" placeholder="Enter your name">
                                <input type="email" placeholder="Enter your email">
                            </div>

                            <!-- Message input but styled like textarea -->
                            <input type="text" class="message-input" placeholder="Enter your message">

                            <button type="submit" class="submit-btn">Submit</button>
                        </form>
                    </div>
                </section>

                <!-- FEEDBACK PAGE -->
                <section id="feedbackPage" class="page">
                    <h2>Feedback / Report</h2>
                    <div class="divider"></div>

                    <!-- Location Problem -->
                    <h3>Report a Problem</h3>
                    <div class="report-item">
                        <input type="checkbox" class="check">
                        <div>
                            <h3>Location Problem</h3>
                            <p>Location wont show in other commuters (driver side)</p>
                        </div>
                    </div>

                    <!-- No jeepneys showing -->
                    <div class="report-item">
                        <input type="checkbox" class="check">
                        <div>
                            <h3>No jeepneys showing</h3>
                            <p>Jeepneys location isn’t visible (commuter side)</p>
                        </div>
                    </div>

                    <!-- Others -->
                    <div class="report-item">
                        <input type="checkbox" class="check">
                        <div style="width: 100%;">
                            <h3>Others:</h3>
                            <input type="text" class="short-input" placeholder="Message your problem here.">
                        </div>
                    </div>

                    <h3>Feedback</h3>
                    <p class="feedbackdescription">Give us an idea on what things we can improve!</p>

                    <input type="text" class="long-input" placeholder="Message your problem here.">

                    <button class="submit-btn">Submit</button>
                </section>

            </main>

        </div>
    </div>

<script type="module" src="../login/supabaseClient.js"></script>
<script type="module" src="settings.js"></script>

</body>
</html>
<script type="module">
    const role = sessionStorage.getItem('userRole') || 'commuter';
    const backBtn = document.getElementById('backBtn');
    if (backBtn) {
        backBtn.addEventListener('click', (e) => {
            e.preventDefault();
            window.location.href = role === 'driver' ? '../mainpage/driver.html' : '../mainpage/commuter.html';
        });
    }
    if (!sessionStorage.getItem('userRole')) {
        try {
            import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm').then(async ({ createClient }) => {
                const supabase = createClient('https://tydvoylhjojxzykdotxf.supabase.co','sb_publishable_A8lnpV3CPNxvieBXuMYmiA_hlSkQUUp');
                const { data: { user } } = await supabase.auth.getUser();
                let r = 'commuter';
                if (user?.user_metadata?.role) {
                    r = user.user_metadata.role;
                } else if (user?.id) {
                    const { data } = await supabase.from('profiles').select('role').eq('id', user.id).maybeSingle();
                    if (data?.role) r = data.role;
                }
                sessionStorage.setItem('userRole', r);
            });
        } catch {}
    }
</script>
</html>
