<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
    <link href="login-style.css" rel="stylesheet">


</head>
<body class="split-screen-body">
    <div class="split-container">
        <!-- Left Side - Registration Form -->
        <div class="split-left-form">
            <div class="form-card">
                <form id="registrationForm" class="auth-form">
                    <h2 class="form-title">Create an account</h2>
                    <div class="form-group">
                        <input 
                            type="text" 
                            id="username" 
                            name="username" 
                            placeholder="Username"
                            minlength="3" 
                            maxlength="30" 
                            pattern="^[a-zA-Z0-9_]+$" 
                            title="Username must be 3-30 characters long and can only contain letters, numbers, and underscores (_)."
                            required>
                    </div>

                    <div class="form-group">
                        <input type="email" id="email" name="email" placeholder="Email" required>
                    </div>

                    <div class="form-group">
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            placeholder="Password" 
                            minlength="8"
                            pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}"
                            title="Password must be at least 8 characters long and include at least 1 uppercase letter, 1 lowercase letter, 1 number, and 1 special character (@$!%*?&)."
                            required>
                    </div>

                    <div class="form-group">
                        <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm password" required>
                    </div>

                    <div class="form-group">
                        <select id="role" name="role" required>
                            <option value="">Select Role</option>
                            <option value="commuter">Commuter</option>
                            <option value="driver">Driver</option>
                        </select>
                    </div>

                    <!-- Commuter-Specific Fields (dynamically required) -->
                    <div id="commuterFields" style="display:none;">
                        <div class="form-group">
                            <input 
                                type="text" 
                                id="identityDocument" 
                                name="identityDocument" 
                                placeholder="Identity Document (ID Number)" 
                                minlength="5" 
                                maxlength="20" 
                                pattern="^\d+$" 
                                inputmode="numeric"
                                oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                                title="ID number must be 5â€“20 digits and numeric only.">
                        </div>
                        <div class="form-group">
                            <label for="commuterIdUpload" class="upload-label">Upload ID Document</label>
                            <input type="file" id="commuterIdUpload" name="commuterIdUpload" accept="image/*,application/pdf">
                        </div>
                    </div>

                    <!-- Driver-Specific Fields (dynamically required) -->
                    <div id="driverFields" style="display:none;">
                        <div class="form-group">
                            <input 
                                type="text" 
                                id="plateNumber" 
                                name="plateNumber" 
                                placeholder="Plate Number (ABC123)" 
                                pattern="^[A-Z]{3}\d{3}$" 
                                maxlength="6"
                                title="Format: 3 letters + 3 digits (ABC123)."
                                style="text-transform:uppercase;"
                                oninput="this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g,'');">
                        </div>
                        <div class="form-group">
                            <input 
                                type="text" 
                                id="licenseNumber" 
                                name="licenseNumber" 
                                placeholder="License Number (A123-45-123456)" 
                                pattern="^[A-Z]\d{3}-?\d{2}-?\d{6}$"
                                maxlength="14" 
                                title="Accepted: A12345123456 or A123-45-123456"
                                style="text-transform:uppercase;"
                                oninput="
                                    let v = this.value.toUpperCase().replace(/[^A-Z0-9]/g,'');
                                    // enforce first char letter, rest digits
                                    if(v.length>0){ v = v[0].replace(/[^A-Z]/g,'') + v.slice(1).replace(/\D/g,''); }
                                    // auto-insert hyphens at positions 4 and 7 for readability
                                    let out = v;
                                    if(out.length > 4) out = out.slice(0,4) + '-' + out.slice(4);
                                    if(out.length > 7) out = out.slice(0,7) + '-' + out.slice(7);
                                    // cap to 14 chars including hyphens
                                    this.value = out.slice(0,14);">
                        </div>
                        <div class="form-group">
                            <label for="driverLicenseUpload" class="upload-label">Upload Driver's License</label>
                            <input type="file" id="driverLicenseUpload" name="driverLicenseUpload" accept="image/*,application/pdf">
                        </div>
                    </div>
                    
                    <!-- Terms and Agreement -->
                    <div class="terms-group">
                        <label class="terms-label">
                            <input type="checkbox" id="termsCheckbox" name="terms" required>
                            <span>I agree to the <a href="#" class="terms-link">Terms and Conditions</a> and <a href="#" class="terms-link">Privacy Policy</a>. I understand that my data will be collected and used in accordance with these policies.</span>
                        </label>
                    </div>
                    
                    <button type="submit" class="auth-btn">Sign up</button>

                    <div class="form-footer">
                        <span class="footer-text">Already have an account? <a href="Log-in.html" class="link-text-bold">Sign in here</a></span>
                    </div>
                </form>
            </div>
        </div>

        <!-- Right Side - Slideshow -->
        <div class="split-right-green">
            <div class="slideshow" id="auth-slideshow">
                <div class="slides"></div>
                <div class="slide-overlay">
                    <div class="quote-text" id="slide-quote"></div>
                    <div class="quote-author" id="slide-author"></div>
                    <div class="slide-indicators" id="slide-indicators"></div>
                </div>
            </div>
        </div>
        </div>
    </div> <!-- .split-container -->

        <!-- Fallback script to ensure role fields appear even if module import fails -->
        <script>
            (function(){
                function roleInit(){
                    var r=document.getElementById('role');
                    var c=document.getElementById('commuterFields');
                    var d=document.getElementById('driverFields');
                    if(!r||!c||!d) return;
                    c.style.display='none';
                    d.style.display='none';
                    if(r.value==='commuter') c.style.display='block';
                    else if(r.value==='driver') d.style.display='block';
                }
                document.addEventListener('DOMContentLoaded', function(){
                    var r=document.getElementById('role');
                    if(r){
                        r.addEventListener('change', roleInit);
                        roleInit();
                    }
                });
            })();
        </script>
        <script type="module" src="supabaseClient.js"></script>
        <script type="module" src="registration.js"></script>
    <script src="login-slideshow.js"></script>
</body>
</html>